<!DOCTYPE html>
<html>
<head>
    <title>Employee Payroll</title>
    <link rel="stylesheet" href="/dashboard.css">
</head>
<body>

<div class="logo-header">
    <svg width="180" height="80" viewBox="0 0 400 250" fill="none" xmlns="http://www.w3.org/2000/svg">
      <path d="M100 60V190H220V165H135V135H200V110H135V85H220V60H100Z" fill="#1A365D"/>
      <path d="M230 60H300M230 85H300M290 60C290 60 305 125 240 125M255 125L300 190" stroke="#38B2AC" stroke-width="22" stroke-linecap="square"/>
      <text x="200" y="235" text-anchor="middle" font-family="Arial, sans-serif" font-weight="900" font-size="28" letter-spacing="1" fill="#1A365D">
        EMPLOYEE <tspan fill="#38B2AC">PAYROLL</tspan>
      </text>
    </svg>
</div>

<div class="container">

    <div class="top-bar">
        <h1>Employee Details</h1>
        <div class="top-actions">
            <div class="search-box">
                <input type="text" id="searchInput" placeholder="Search employees..." onkeyup="searchEmployees()">
                <span class="search-icon">üîç</span>
            </div>
            <a href="/add" class="add-btn">+ Add User</a>
        </div>
    </div>

    <div class="card">
        <table id="employeeTable">
            <thead>
                <tr>
                    <th>NAME</th>
                    <th>GENDER</th>
                    <th>DEPARTMENT</th>
                    <th>SALARY</th>
                    <th>START DATE</th>
                    <th>ACTIONS</th>
                </tr>
            </thead>

            <tbody>

            <% if (employees.length === 0) { %>
                <tr>
                    <td colspan="6" class="no-data">No Employees Found</td>
                </tr>
            <% } else { %>

                <% employees.forEach(emp => { %>
                    <tr>

                        <!-- Name + Avatar -->
                        <td class="name-cell">
                            <% if (emp.profileImage) { %>
                                <img src="https://i.pravatar.cc/150?img=<%= emp.profileImage.replace('.png', '') %>" alt="<%= emp.name %>" class="avatar-img">
                            <% } else { %>
                                <div class="avatar">
                                    <%= emp.name.charAt(0).toUpperCase() %>
                                </div>
                            <% } %>
                            <span><%= emp.name %></span>
                        </td>

                        <!-- Gender -->
                        <td>
                            <span class="gender <%= emp.gender.toLowerCase() %>">
                                <%= emp.gender %>
                            </span>
                        </td>

                        <!-- Department -->
                        <td class="department-cell">
                            <% emp.department.forEach(dept => { %>
                                <span class="dept-badge"><%= dept %></span>
                            <% }) %>
                        </td>

                        <!-- Salary (Net Salary after tax deduction) -->
                        <td class="salary-cell">‚Çπ <%= emp.netSalary.toLocaleString('en-IN', {maximumFractionDigits: 0}) %></td>

                        <!-- Start Date -->
                        <td><%= emp.startDate %></td>

                        <!-- Actions -->
                        <td class="actions">
                            <a href="/edit/<%= emp.id %>" class="action-btn edit-btn" title="Edit">‚úèÔ∏è</a>
                            <a href="/delete/<%= emp.id %>" class="action-btn delete-btn" onclick="return confirm('Are you sure you want to delete this employee?');" title="Delete">üóëÔ∏è</a>
                        </td>

                    </tr>
                <% }) %>

            <% } %>

            </tbody>
        </table>
    </div>

</div>

<script>
function searchEmployees() {
    const input = document.getElementById('searchInput');
    const filter = input.value.toLowerCase();
    const table = document.querySelector('table tbody');
    const rows = table.getElementsByTagName('tr');

    for (let i = 0; i < rows.length; i++) {
        const row = rows[i];
        const nameCell = row.getElementsByTagName('td')[0];
        
        if (nameCell) {
            const textValue = nameCell.textContent || nameCell.innerText;
            if (textValue.toLowerCase().indexOf(filter) > -1) {
                row.style.display = '';
            } else {
                row.style.display = 'none';
            }
        }
    }
}
</script>

</body>
</html>

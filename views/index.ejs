<!DOCTYPE html>
<html>
<head>
    <title>Employee Payroll</title>
    <link rel="stylesheet" href="/dashboard.css">
    <style>
        .profile-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            margin-right: 10px;
            display: inline-block;
            vertical-align: middle;
            border: 2px solid #ddd;
        }
        
        .name-cell {
            display: flex;
            align-items: center;
        }
        
        .badge {
            margin-right: 5px;
            display: inline-block;
        }
    </style>
</head>
<body>

<div class="logo-header">
    <svg width="180" height="80" viewBox="0 0 400 250" fill="none" xmlns="http://www.w3.org/2000/svg">
      <path d="M100 60V190H220V165H135V135H200V110H135V85H220V60H100Z" fill="#1A365D"/>
      <path d="M230 60H300M230 85H300M290 60C290 60 305 125 240 125M255 125L300 190" stroke="#38B2AC" stroke-width="22" stroke-linecap="square"/>
      <text x="200" y="235" text-anchor="middle" font-family="Arial, sans-serif" font-weight="900" font-size="28" letter-spacing="1" fill="#1A365D">
        EMPLOYEE <tspan fill="#38B2AC">PAYROLL</tspan>
      </text>
    </svg>
</div>

<div class="container">

    <div class="top-bar">
        <h1>Employee Details</h1>
        <div class="top-actions">
            <div class="search-box">
                <input type="text" id="searchInput" placeholder="Search employees..." onkeyup="searchEmployees()">
                <span class="search-icon">üîç</span>
            </div>
            <a href="/add" class="add-btn">+ Add User</a>
        </div>
    </div>

    <div class="card">
        <table id="employeeTable">
            <thead>
                <tr>
                    <th>Name</th>
                    <th>Gender</th>
                    <th>Department</th>
                    <th>Salary</th>
                    <th>Tax (12%)</th>
                    <th>Net Salary</th>
                    <th>Start Date</th>
                    <th>Actions</th>
                </tr>
            </thead>

            <tbody>

            <% if (employees.length === 0) { %>
                <tr>
                    <td colspan="8" class="no-data">No Employees Found</td>
                </tr>
            <% } else { %>

                <% employees.forEach(emp => { %>
                    <tr>

                        <!-- Name + Avatar -->
                        <td class="name-cell">
                            <% if (emp.profileImage) { %>
                                <% 
                                    const imageUrls = {
                                        '1.png': 'https://images.unsplash.com/photo-1494790108755-2616c669e297?w=100&h=100&fit=crop&crop=face',
                                        '2.png': 'https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=100&h=100&fit=crop&crop=face',
                                        '3.png': 'https://images.unsplash.com/photo-1438761681033-6461ffad8d80?w=100&h=100&fit=crop&crop=face',
                                        '4.png': 'https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?w=100&h=100&fit=crop&crop=face'
                                    };
                                    const profileUrl = imageUrls[emp.profileImage] || imageUrls['1.png'];
                                %>
                                <div class="profile-avatar" style="background: url('<%= profileUrl %>') center/cover;"></div>
                            <% } else { %>
                                <div class="avatar">
                                    <%= emp.name.charAt(0).toUpperCase() %>
                                </div>
                            <% } %>
                            <span><%= emp.name %></span>
                        </td>

                        <!-- Gender -->
                        <td>
                            <span class="gender <%= emp.gender.toLowerCase() %>">
                                <%= emp.gender %>
                            </span>
                        </td>

                        <!-- Department -->
                        <td>
                            <% if (Array.isArray(emp.department)) { %>
                                <% emp.department.forEach((dept, index) => { %>
                                    <span class="badge"><%= dept %></span><% if (index < emp.department.length - 1) { %>, <% } %>
                                <% }) %>
                            <% } else { %>
                                <span class="badge"><%= emp.department %></span>
                            <% } %>
                        </td>

                        <!-- Salary -->
                        <td>‚Çπ <%= (emp.salary || emp.basicSalary).toLocaleString() %></td>

                        <!-- Tax -->
                        <td>‚Çπ <%= emp.tax.toFixed(2) %></td>

                        <!-- Net Salary -->
                        <td>‚Çπ <%= emp.netSalary.toFixed(2) %></td>

                        <!-- Start Date -->
                        <td><%= emp.startDate || 'N/A' %></td>

                        <!-- Actions -->
                        <td class="actions">
                            <a href="/edit/<%= emp.id %>" class="action-btn edit-btn" title="Edit">‚úèÔ∏è</a>
                            <a href="/delete/<%= emp.id %>" class="action-btn delete-btn" onclick="return confirm('Are you sure you want to delete this employee?');" title="Delete">üóëÔ∏è</a>
                        </td>

                    </tr>
                <% }) %>

            <% } %>

            </tbody>
        </table>
    </div>

</div>

<script>
function searchEmployees() {
    const input = document.getElementById('searchInput');
    const filter = input.value.toLowerCase();
    const table = document.querySelector('table tbody');
    const rows = table.getElementsByTagName('tr');

    for (let i = 0; i < rows.length; i++) {
        const row = rows[i];
        const nameCell = row.getElementsByTagName('td')[0];
        
        if (nameCell) {
            const textValue = nameCell.textContent || nameCell.innerText;
            if (textValue.toLowerCase().indexOf(filter) > -1) {
                row.style.display = '';
            } else {
                row.style.display = 'none';
            }
        }
    }
}
</script>

</body>
</html>